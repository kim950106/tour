// Google Apps Script 웹앱 URL (3단계에서 복사한 URL)
const WEBAPP_URL = '1L25EahxkY5tjf8wgo-9ntMIohO4ZqnXCIwQ1B5nVOpo';

document.getElementById('partnerForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const errorMessage = document.getElementById('errorMessage');
    const successMessage = document.getElementById('successMessage');
    const form = document.getElementById('partnerForm');
    
    // 에러 메시지 숨기기
    errorMessage.style.display = 'none';
    
    // 버튼 비활성화 및 로딩 상태
    submitBtn.disabled = true;
    submitBtn.textContent = '등록 중...';
    
    // 폼 데이터 수집
    const formData = new FormData(this);
    const data = {
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone') || '',
        business: formData.get('business'),
        experience: formData.get('experience') || '',
        inquiry: formData.get('inquiry') || '',
        newsletter: formData.get('newsletter') === 'yes' ? '동의' : '비동의'
    };
    
    // 유효성 검사
    if (!data.name || !data.email || !data.business) {
        showError('필수 항목을 모두 입력해주세요.');
        return;
    }
    
    if (!formData.get('privacy')) {
        showError('개인정보 수집 및 이용에 동의해주세요.');
        return;
    }
    
    // Google Apps Script로 데이터 전송
    fetch(WEBAPP_URL, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        if (result.result === 'success') {
            // 성공 처리
            form.style.display = 'none';
            successMessage.style.display = 'block';
        } else {
            throw new Error(result.message || '알 수 없는 오류가 발생했습니다.');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showError('등록 중 오류가 발생했습니다. 다시 시도해주세요.');
    });
    
    function showError(message) {
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
        submitBtn.disabled = false;
        submitBtn.textContent = '파트너 등록하기';
    }
});
